<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> SOTA Dataset Generation in NLP | Patrick Haller&#39;s Blog </title> <meta name="description" content=" Paper Publication "> <meta name="keywords" content="NLP, ML, Language Modelling"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Patrick Haller"> <meta property="article:section" content=""> <meta property="article:tag" content="NLP, ML, Language Modelling"> <meta property="article:published_time" content="2024-02-14 00:00:00 +0100"> <meta property="og:url" content="https://hallerpatrick.github.io/news/blog/2024/fabricator/"> <meta property="og:title" content=" SOTA Dataset Generation in NLP | Patrick Haller&#39;s Blog "> <meta property="og:image" content="https://hallerpatrick.github.io/news/assets/images/favicon.ico"> <meta property="og:description" content=" Paper Publication "> <meta property="og:site_name" content="Patrick Haller"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content=""> <meta name="twitter:title" content=" SOTA Dataset Generation in NLP | Patrick Haller&#39;s Blog "> <meta name="twitter:description" content=" Paper Publication "> <meta name="twitter:image:src" content="https://hallerpatrick.github.io/news/assets/images/favicon.ico"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" SOTA Dataset Generation in NLP | Patrick Haller&#39;s Blog "> <meta itemprop="description" content=" Paper Publication "> <meta itemprop="image" content="https://hallerpatrick.github.io/news/assets/images/favicon.ico"> <!-- Canonical link tag --> <link rel="canonical" href="https://hallerpatrick.github.io/news/blog/2024/fabricator/"> <link rel="alternate" type="application/rss+xml" title="Patrick Haller's Blog" href="https://hallerpatrick.github.io/news/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> <link rel="stylesheet" href="https://hallerpatrick.github.io/news/assets/css/main.css"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://hallerpatrick.github.io/news/"><i class="fa fa-circle" style="color:orange"></i> Patrick Haller's<span> Blog</span></a></h1> <ul class="navbar"> <li><a style="color:black" href="https://hallerpatrick.github.io/news/news">News</a></li> <li><a style="color:black" href="https://hallerpatrick.github.io/news/about">About me</a></li> <li><a style="color:black" href="https://hallerpatrick.github.io/news/feed.xml" target="_blank">RSS</a></li> <li> <!-- <button id="theme-toggle" aria-label="Toggle dark mode"> --> <!-- <p id="mode-text">Dark Mode</p> --> <!-- </button> --> </li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2024-02-14T00:00:00+01:00" itemprop="datePublished">Feb 14, 2024</time></p> <h1 class="post-title" itemprop="name headline">Fabricator: SOTA Dataset Generation in NLP</h1> </header> <div class="post-content" itemprop="articleBody"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /> <blockquote> <p>Following post is a short summary of a paper I worked on with. <i class="fa fa-book"></i> Read the full paper <a href="https://arxiv.org/pdf/2309.09582.pdf">here</a>.</p> </blockquote> <blockquote> <p>Our paper got accepted at EMNLP 2023 Demo Track!</p> </blockquote> <p>In the realm of machine and especially NLP, the creation of high-quality labeled data has been a significant bottleneck. We therfore present Fabricator, a <strong>toolkit designed to harness the power of LLMs for generating vast, labeled datasets</strong>. This approach not only promises to save time and resources but also opens new avenues for research and application in machine learning.</p> <h2 id="how-it-works">How It Works</h2> <p>By prompting LLMs to produce data for specific tasks, Fabricator efficiently creates training material for downstream NLP models. Imagine generating hundreds of movie reviews with varying sentiments at the push of a button.</p> <div class="divider"></div> <p align="center"> <img src="/assets/images/fabricator_overview.png" alt="Fabricator" width="500" /> </p> <p><strong>The process of learning via dataset generation. A teacher model (LLM) is prompted to generate 500 movie reviews for each sentiment (positive, negative). A smaller student PLM is trained on the generated dataset.</strong></p> <hr /> <div class="divider"></div> <h3 id="versatility-and-integration">Versatility and Integration</h3> <p>Fabricator supports a wide array of NLP tasks and offering seamless integration with well-known libraries. Whether you’re working on text classification, entity recognition, or any other NLP challenge, Fabricator helps you generate the data you need.</p> <p align="center"> <img src="/assets/images/fabricator_template.png" alt="Fabricator" width="500" /> </p> <p><strong>With FABRICATOR, the generation process involves a prompt template that creates the final prompt using all provided arguments. The generator class creates training examples until the maximum number of prompt calls is reached, or the unlabeled dataset is fully annotated. Ultimately, the generator class produces a HuggingFace Dataset instance.</strong></p> <div class="divider"></div> <h3 id="empowering-research-and-development">Empowering Research and Development</h3> <p>By providing a means to quickly generate and experiment with new datasets, Fabricator paves the way for innovative research and practical applications in NLP.</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="kn">from</span> <span class="nn">haystack.nodes</span> <span class="kn">import</span> <span class="n">PromptNode</span>
<span class="kn">from</span> <span class="nn">fabricator</span> <span class="kn">import</span> <span class="n">DatasetGenerator</span><span class="p">,</span> <span class="n">BasePrompt</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s">"processed_fewshot_imdb"</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s">"train"</span><span class="p">)</span>

<span class="n">prompt</span> <span class="o">=</span> <span class="n">BasePrompt</span><span class="p">(</span>
    <span class="n">task_description</span><span class="o">=</span><span class="s">"Generate a {} movie review."</span><span class="p">,</span>
    <span class="n">label_options</span><span class="o">=</span><span class="p">[</span><span class="s">"positive"</span><span class="p">,</span> <span class="s">"negative"</span><span class="p">],</span>
    <span class="n">generate_data_for_column</span><span class="o">=</span><span class="s">"text"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">prompt_node</span> <span class="o">=</span> <span class="n">PromptNode</span> <span class="p">(</span>
    <span class="n">model_name_or_path</span><span class="o">=</span><span class="s">"gpt-3.5-turbo"</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"OPENAI_API_KEY"</span><span class="p">),</span>
    <span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">generator</span> <span class="o">=</span> <span class="n">DatasetGenerator</span><span class="p">(</span><span class="n">prompt_node</span><span class="p">)</span>
<span class="n">generated_dataset</span> <span class="o">=</span> <span class="n">generator</span><span class="p">.</span><span class="n">generate</span><span class="p">(</span>
    <span class="n">prompt_template</span><span class="o">=</span><span class="n">prompt</span> <span class="p">,</span>
    <span class="n">fewshot_dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
    <span class="n">fewshot_sampling_strategy</span><span class="o">=</span><span class="s">"uniform "</span><span class="p">,</span>
    <span class="n">fewshot_examples_per_class</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">fewshot_sampling_column</span><span class="o">=</span><span class="s">"label"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">generated_dataset</span><span class="p">.</span><span class="n">push_to_hub</span><span class="p">(</span><span class="s">"generated-movie-reviews"</span><span class="p">)</span>
</code></pre></div></div> <p><strong>A script that uses FABRICATOR and generates additional movie reviews based on few-shot examples</strong></p> <div class="divider"></div> <p>Looking Ahead - As the toolkit evolves, it promises to expand its capabilities, supporting an even broader range of tasks and enhancing the NLP community’s ability to tackle complex problems with novel solutions.</p> <p>For more details, refer to the original paper: <a href="https://arxiv.org/pdf/2309.09582.pdf">Fabricator</a></p> </div> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2024 Patrick Haller &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/heiswayi/thinkspace">Thinkspace theme</a></small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-XXXXX-XX']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> <script src="https://hallerpatrick.github.io/news/assets/js/themer.js"></script> </html>
